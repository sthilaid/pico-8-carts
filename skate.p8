pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
--skate by sthilaid

-- globals
g_lastFrameTime=0
g_skate={}
g_jmpImpulse = 3
g_inairAnimUp={1,5,9,13,9,5,1}

-->8
-- updates
function _init()
   g_skate = {x=64,y=64,z=0,v=0,vz=0,dir=0,state=0,
              spriteSize=4}
end

function _update()
   local t = time()
   local dt = t - g_lastFrameTime
   g_lastFrameTime = t

   -- state 0: ground
   if g_skate.state == 0 then
      local dx,dy = 0,0
      if btnp(5) then
         if btn(0) or btn(1) then
            g_skate.state = 2 -- x+side -> flip trick
         else
            g_skate.state = 1 -- x+side -> ollie
         end
         g_skate.vz = g_jmpImpulse -- m/s
      end
   end
   -- in air
   if g_skate.state == 1 or g_skate.state == 2 then
      g_skate.z += g_skate.vz*dt
      g_skate.vz -= 9.8*dt

      if g_skate.z < 0 then
         g_skate.z, g_skate.vz = 0, 0
         g_skate.state = 0 -- ground
      end
   end
end

function _draw()
   cls()
   print("s:"..g_skate.state.." z:"..g_skate.z.." vz:"..g_skate.vz)
   
   local centerDelta = -g_skate.spriteSize*4 -- /2 * 8
   if g_skate.state == 0 then
      spr(1, g_skate.x+centerDelta, g_skate.y+centerDelta, g_skate.spriteSize, g_skate.spriteSize)
   elseif g_skate.state == 1 then
      if g_skate.vz > 0 then
         local sprIndex = flr((1.0 - g_skate.vz / g_jmpImpulse) * #g_inairAnimUp + 1)
         local inairSprite = g_inairAnimUp[sprIndex]
         spr(inairSprite, g_skate.x+centerDelta, g_skate.y+centerDelta, g_skate.spriteSize, g_skate.spriteSize)
      else
         spr(1, g_skate.x+centerDelta, g_skate.y+centerDelta, g_skate.spriteSize, g_skate.spriteSize)
      end
   end
end

__gfx__
00000000000000000000000555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000555555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000005555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000005555555555500000000000000000000000004444000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000005555555555500000000000000000000000444444440000000000000000000000000000000000000000000000000000000000000000000
00700700000000000055555555555550000000000000000000004555555554000000000000000000000000000000000000000000000000000000000000000000
00000000000000000055555555555550000000000000000000045555555555400000000000000000000844444444480000000000000000000000000000000000
00000000000000000055555555555550000000000000000000555555555555500000000000000000008444444444448000000000000000000000000000000000
00000000000000000055555555555550000000000000000000555555555555500000000000000000004444444444444000000000000000088000000000880000
00000000000000000055555555555550000000000000000000555555555555500000000000000000004445555555544000000000000000088666666666880000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000088444444444880000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000084444444444480000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000044444444444440000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000044455555555440000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555550000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000055555555555500000000000000000000555555555555500000000000000000005555555555555000000000000000055555555555550000
00000000000000000005555555555500000000000000000000555555555555000000000000000000005555555555550000000000000000055555555555500000
00000000000000000005555555555500000000000000000000055555555555000000000000000000000555555555550000000000000000005555555555500000
00000000000000000005555555555500000000000000000000055555555555000000000000000000000555555555550000000000000000005555555555500000
00000000000000000005555555555000000000000000000000005555555550000000000000000000000055555555500000000000000000000555555555000000
00000000000000000000555555550000000000000000000000005555555500000000000000000000000055555555000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000005555555555555555555550000000000004555555555555555555550000000000008445555555555555555500000000000008888445555555555
00000000005555555555555555555555555555000000045555555555555555555555550000000084445555555555555555555500000000008884445555555555
00000000055555555555555555555555555555500000455555555555555555555555555000000044455555555555555555555550000000000644455555555555
00000000055555555555555555555555555555550000455555555555555555555555555500000044455555555555555555555555000000000644455555555555
00000000555555555555555555555555555555550004455555555555555555555555555500000044455555555555555555555555000000000644455555555555
00000000555555555555555555555555555555550004455555555555555555555555555500000044455555555555555555555555000000000644455555555555
00000000555555555555555555555555555555550004455555555555555555555555555500000044455555555555555555555555000000000644455555555555
00000000555555555555555555555555555555550004455555555555555555555555555500000044455555555555555555555555000000000644455555555555
00000000055555555555555555555555555555550000455555555555555555555555555500000044455555555555555555555555000000000644455555555555
00000000055555555555555555555555555555550000455555555555555555555555555500000044455555555555555555555555000000000644455555555555
00000000055555555555555555555555555555550000045555555555555555555555555500000044445555555555555555555555000000000644445555555555
00000000005555555555555555555555555555500000004555555555555555555555550000000084445555555555555555555500000000008884445555555555
00000000000005555555555555555555555000000000000555555555555555555555000000000008445555555555555555550000000000008888445555555555
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000055555555555000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000005555555550000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000005555555500000000000000000000000000000000000
